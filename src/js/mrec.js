!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.mrec=o():e.mrec=o()}(self,(function(){return(()=>{"use strict";var e={d:(o,n)=>{for(var t in n)e.o(n,t)&&!e.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:n[t]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{downloadVideo:()=>m,logMediaDevices:()=>n,modalContent:()=>d,openVideoPlayback:()=>a,openVideoPreview:()=>i,startRecorder:()=>c,startStream:()=>r,stopRecorder:()=>s,stopStream:()=>l,toggleModal:()=>t,uploadVideo:()=>p});const n=(e=!0,o=!0,n=!1)=>{navigator.mediaDevices.enumerateDevices().then((t=>{t.forEach((t=>{console.log(`${e&&t.kind.toUpperCase()}, ${o&&t.label}, ${n&&t.deviceId}`)}))})).catch((e=>{console.log(e.name,e.message)}))},t=()=>{window.location.href=-1!==window.location.href.indexOf("#greeting-modal")?"#":"#greeting-modal"},d=(e="<h1>Hi</h1>",o="deeppink")=>{const n=document.getElementById("modal-content");document.getElementById("modal").style.backgroundColor=o,"#video-preview"===e?(document.getElementById("video-playback").style.display="none",n.innerHTML="",document.getElementById("video-preview").style.display="block"):"#video-playback"===e?(document.getElementById("video-preview").style.display="none",n.innerHTML="",document.getElementById("video-playback").style.display="block"):(document.getElementById("video-preview").style.display="none",document.getElementById("video-playback").style.display="none",n.innerHTML=e),window.location.href="#greeting-modal"},i=()=>{d("#video-preview","white")},a=()=>{d("#video-playback","white")},r=(e={audio:!0,video:{facingMode:"user",frameRate:15}})=>{navigator.mediaDevices.getUserMedia(e).then((e=>{window.localStream=e;const o=document.querySelector("#video-preview");"srcObject"in o?o.srcObject=e:o.src=window.URL.createObjectURL(e),o.onloadedmetadata=()=>o.play()})).catch((e=>console.log(e.name,e.message)))},l=()=>{"localStream"in window&&window.localStream.getTracks().forEach((e=>e.stop()))},c=(e={audio:!0,video:{facingMode:"user"},frameRate:15})=>{let o={mimeType:"video/webm;codecs=vp9,opus"};MediaRecorder.isTypeSupported(o.mimeType)||(console.error(`${o.mimeType} is not supported, using vp8`),o={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(o.mimeType)||(console.error(`${o.mimeType} is not supported`),o={mimeType:"video/webm"},MediaRecorder.isTypeSupported(o.mimeType)||(console.error(`${o.mimeType} is not supported`),o={mimeType:""}))),navigator.mediaDevices.getUserMedia(e).then((e=>{window.localStream=e;const n=document.querySelector("#video-preview");"srcObject"in n?n.srcObject=e:n.src=window.URL.createObjectURL(e),n.onloadedmetadata=()=>n.play(),window.MediaRecorder=new MediaRecorder(window.localStream,o),window.dataChunks=[],window.MediaRecorder.start(),console.log(window.MediaRecorder.state),window.MediaRecorder.ondataavailable=e=>window.dataChunks.push(e.data)})).catch((e=>console.log(e.name,e.message)))},s=()=>{"MediaRecorder"in window&&"recording"===window.MediaRecorder.state&&(window.MediaRecorder.stop(),console.log(window.MediaRecorder.state),window.MediaRecorder.onstop=()=>{window.blobvid=new Blob(window.dataChunks,{type:"video/webm"}),window.dataChunks=[],window.videoURL=window.URL.createObjectURL(window.blobvid),document.getElementById("video-playback").src=window.videoURL}),l()},p=(e,o="upload_video.php")=>{if(window.blobvid){window.onbeforeunload=e=>{e.preventDefault(),e.returnValue=""};const n={fname:(new Date).toISOString().replaceAll(":","-").replace(".","-"),uploadContent:"<h1>Uploading</h1>",uploadColor:"coral",successContent:"<h1>Successful</h1>",successColor:"cyan",...e};d(n.uploadContent,n.uploadColor);const t=o,i=new FormData;i.append("vidfile",window.blobvid,n.fname),fetch(t,{method:"POST",body:i}).then().then((()=>{window.onbeforeunload=null,d(n.successContent,n.successColor)})).catch(console.error)}else d("<h1>No recording was found ðŸ˜”</h1>","PeachPuff")},m=(e="video.webm")=>{if(window.blobvid){console.log(e);const o=document.createElement("a");o.href=window.videoURL,o.download=e,o.click(),o.remove()}else console.log("Not video found in window object")};return(()=>{const e=document.createElement("style");e.innerHTML="\n  /* Greeting Modal Container */\n  #greeting-modal {\n    visibility: hidden;\n    opacity: 0;\n    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);\n  }\n  \n  /* Greeting Modal Container - when open */\n  #greeting-modal:target {\n    visibility: visible;\n    opacity: 1;\n  }\n  \n  /* Greeting Modal */\n  #greeting-modal #modal {\n    opacity: 0;\n    transform: translateY(-1rem);\n    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);\n    transition-delay: 0.1s;\n  }\n  \n  /* Greeting Modal - when open */\n  #greeting-modal:target #modal {\n  transform: translateY(0);\n  opacity: 1;\n  }\n  \n  /* Modal Container Styles for flex box */\n  .modal-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    backdrop-filter: blur(5px);\n  }\n  \n  /* Modal Background Styles */\n  .modal-bg {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.3);\n    backdrop-filter: blur(5px);\n  }\n  \n  /* Modal Body Styles */\n  #modal {\n    z-index: 1;\n    background-color: white;\n    width: max-content; /* 500px */\n    padding: 1rem;\n    border-radius: 8px;\n  }\n  \n  #modal .close {\n    position: absolute;\n    right: -16px;\n    top: -16px;\n    width: 32px;\n    height: 32px;\n    opacity: 0.3;\n  }\n  #modal .close:hover {\n    opacity: 1;\n  }\n\n  #modal .close:before, .close:after {\n    position: absolute;\n    left: 16px;\n    content: ' ';\n    height: 34px;\n    width: 3px;\n    background-color: #333;\n  }\n  #modal .close:before {\n    transform: rotate(45deg);\n  }\n  #modal .close:after {\n    transform: rotate(-45deg);\n  }\n  \n  \n",document.head.appendChild(e);const o=document.createRange().createContextualFragment('\n  \x3c!-- Modal container --\x3e\n  <div class="modal-container" id="greeting-modal">\n\n    \x3c!-- Modal  --\x3e\n    <div id="modal">\n      <video id="video-preview" muted style="display: none;"></video>\n      <video id="video-playback" controls style="display: none"></video>\n      <div id="modal-content"></div>\n      <a href="#" class="close">\n    </div>\n\n    \x3c!-- Background, click to close --\x3e\n    <a href="#" class="modal-bg"></a>\n  </div>\n');document.body.appendChild(o)})(),o})()}));
//# sourceMappingURL=index-umd.js.map